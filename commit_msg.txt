Improve Supabase insertion robustness and error logging